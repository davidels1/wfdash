{% load static %}

<script>
  "use strict";
  document.addEventListener("DOMContentLoaded", function () {
    // =========================================================
    // =========    Menu Customizer [ HTML ] code   ============
    // =========================================================
    document.querySelector('body').insertAdjacentHTML("beforeend", '' +
      '<div id="styleSelector" class="menu-styler">' +
      '<div class="style-toggler">' +
      '<a href="#!"></a>' +
      '</div>' +
      '<div class="style-block">' +
      '<h6 class="mb-2">Datta Able Live Menu Customizer</h6>' +
      '<hr class="my-0">' +

      // Reset Button - New
      '<div class="my-3">' +
      '<button id="reset-settings" class="btn btn-danger btn-sm w-100">Reset All Settings</button>' +
      '</div>' +

      '<h6>Layouts</h6>' +
      '<div class="theme-color layout-type">' +
      '<a href="#!" class=" active" data-value="menu-dark" data-bs-toggle="tooltip" title="Default Layout"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="menu-light" data-bs-toggle="tooltip" title="Light"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="dark" data-bs-toggle="tooltip" title="Dark"><span></span><span></span></a>' +
      '</div>' +

      /* Prebuild Layout section commented out
      '<h6>Prebuild Layout</h6>' +
      '<p class="f-12"><span class="text-c-red">*</span> in Prebuild Layout you redirect to new page</p>' +
      '<div class="theme-color prelayout-color">' +
      '<a href="{% url 'index_2' %}" class="" data-value="l2" target="_blank"><span></span><span></span></a>' +
      '<a href="{% url 'index_2_2' %}" class="" data-value="l2-2" target="_blank"><span></span><span></span></a>' +
      '<a href="{% url 'index_3' %}" class="" data-value="l3" target="_blank"><span></span><span></span></a>' +
      '<a href="{% url 'index_4' %}" class="" data-value="l4" target="_blank"><span></span><span></span></a>' +
      '<a href="{% url 'index_4_2' %}" class="" data-value="l4-2" target="_blank"><span></span><span></span></a>' +
      '<a href="{% url 'index_5h' %}" class="" data-value="l5-h" target="_blank"><span></span><span></span></a>' +
      '<a href="{% url 'index_light' %}" class="" data-value="l-lite" target="_blank"><span></span><span></span></a>' +
      '<a href="{% url 'index_6' %}" class="" data-value="l6" target="_blank"><span></span><span></span></a>' +
      '<a href="{% url 'index_8' %}" class="" data-value="l8" target="_blank"><span></span><span></span></a>' +
      '<a href="{% url 'index_1' %}" class="" data-value="l1" target="_blank"><span></span><span></span></a>' +
      '</div>' +
      */

      '<div class="form-group mb-3">' +
      '<div class="switch switch-primary d-inline m-r-10">' +
      '<input type="checkbox" id="icon-colored">' +
      '<label for="icon-colored" class="cr"></label>' +
      '</div>' +
      '<label>Icon Color</label>' +
      '</div>' +
      '<ul class="nav nav-pills mb-2 text-center" id="pills-cust-tab" role="tablist">' +
      '<li class="nav-item">' +
      '<a class="nav-link active" id="pills-color-tab" data-bs-toggle="pill" href="#pills-color" role="tab" aria-controls="pills-color" aria-selected="true">Color</a>' +
      '</li>' +
      '<li class="nav-item">' +
      '<a class="nav-link" id="pills-pages-tab" data-bs-toggle="pill" href="#pills-pages" role="tab" aria-controls="pills-pages" aria-selected="false">Layout</a>' +
      '</li>' +
      '<li class="nav-item">' +
      '<a class="nav-link" id="pills-extra-tab" data-bs-toggle="pill" href="#pills-extra" role="tab" aria-controls="pills-extra" aria-selected="false">Extra</a>' +
      '</li>' +
      '</ul>' +
      '<div class="tab-content" id="pills-cust-tabContent">' +
      '<div class="tab-pane fade show active" id="pills-color" role="tabpanel" aria-labelledby="pills-color-tab">' +
      '<h6>header background</h6>' +
      '<div class="theme-color header-color">' +
      '<a href="#!" class=" active" data-value="header-default"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="header-blue"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="header-green"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="header-orange"><span></span><span></span></a>' +
      // Add more colors here
      '</div>' +
      '<h6>Menu background</h6>' +
      '<div class="theme-color navbar-color">' +
      '<a href="#!" class=" active" data-value="navbar-default"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="navbar-blue"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="navbar-red"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="navbar-purple"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="navbar-lightblue"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="navbar-dark"><span></span><span></span></a>' +
      '</div>' +
      '<h6>Menu Brand Color</h6>' +
      '<div class="theme-color brand-color">' +
      '<a href="#!" class=" active" data-value="brand-default"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="brand-blue"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="brand-red"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="brand-purple"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="brand-lightblue"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="brand-dark"><span></span><span></span></a>' +
      '</div>' +
      '<h6>Navbar Image</h6>' +
      '<div class="theme-color navbar-images">' +
      '<a href="#!" class="active" data-value=""><span class="text-center bg-light" style="width: 30px; height: 30px; line-height: 30px; font-size: 12px;">NONE</span></a>' +
      '<a href="#!" class="" data-value="navbar-image-1"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="navbar-image-2"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="navbar-image-3"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="navbar-image-4"><span></span><span></span></a>' +
      '<a href="#!" class="" data-value="navbar-image-5"><span></span><span></span></a>' +
      '</div>' +
      '</div>' +
      '<div class="tab-pane fade" id="pills-pages" role="tabpanel" aria-labelledby="pills-pages-tab">' +
      '<div class="form-group mb-0">' +
      '<div class="switch switch-primary d-inline m-r-10">' +
      '<input type="checkbox" id="theme-rtl">' +
      '<label for="theme-rtl" class="cr"></label>' +
      '</div>' +
      '<label>RTL</label>' +
      '</div>' +
      '<div class="form-group mb-0">' +
      '<div class="switch switch-primary d-inline m-r-10">' +
      '<input type="checkbox" id="menu-fixed" checked>' +
      '<label for="menu-fixed" class="cr"></label>' +
      '</div>' +
      '<label>Menu Fixed</label>' +
      '</div>' +
      '<div class="form-group mb-0">' +
      '<div class="switch switch-primary d-inline m-r-10">' +
      '<input type="checkbox" id="header-fixed">' +
      '<label for="header-fixed" class="cr"></label>' +
      '</div>' +
      '<label>Header Fixed</label>' +
      '</div>' +
      '<div class="form-group mb-0">' +
      '<div class="switch switch-primary d-inline m-r-10">' +
      '<input type="checkbox" id="box-layouts">' +
      '<label for="box-layouts" class="cr"></label>' +
      '</div>' +
      '<label>Box Layouts</label>' +
      '</div>' +
      '</div>' +
      '</div>' +
      '</div>' +
      '</div>');

    // Add reset button handler
    document.getElementById('reset-settings').addEventListener('click', function() {
      localStorage.removeItem('themeSettings');
      console.log('Settings reset');
      window.location.reload();
    });

    setTimeout(function () {
      document.querySelector('#pills-cust-tabContent').style.cssText = `
              height: calc(100vh - 430px);
              position: relative;
          `;
      var px = new PerfectScrollbar('#pills-cust-tabContent', {
        wheelSpeed: .5,
        swipeEasing: 0,
        suppressScrollX: !0,
        wheelPropagation: 1,
        minScrollbarLength: 40,
      });
    }, 400);
    // =========================================================
    // ==================    Menu Customizer Start   ===========
    // =========================================================
    // open Menu Styler
    var pctoggle = document.querySelector("#styleSelector > .style-toggler");
    if (pctoggle) {
      pctoggle.addEventListener('click', function () {
        if (!document.querySelector("#styleSelector").classList.contains('open')) {
          document.querySelector("#styleSelector").classList.add("open");
        } else {
          document.querySelector("#styleSelector").classList.remove("open");
        }
      });
    }
    // // layout types
    var layouttypes = document.querySelectorAll(".layout-type > a");
    for (var h = 0; h < layouttypes.length; h++) {
      var c = layouttypes[h];
      c.addEventListener('click', function (event) {
        document.querySelector(".layout-type > a.active").classList.remove("active");
        var targetElement = event.target;
        if (targetElement.tagName == "SPAN") {
          targetElement = targetElement.parentNode;
        }
        targetElement.classList.add("active");
        var temp = targetElement.getAttribute('data-value');
        document.querySelector('head').insertAdjacentHTML("beforeend", '<link rel="stylesheet" class="layout-css" href="">');
        if (temp == "menu-dark") {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'menu-');
          document.querySelector(".pcoded-navbar").classList.add('navbar-dark');
        }
        if (temp == "menu-light") {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'menu-');
          document.querySelector(".pcoded-navbar").classList.remove(('navbar-dark'));
          document.querySelector(".pcoded-navbar").classList.add(temp);
        }
        if (temp == "reset") {
          location.reload();
        }
        if (temp == "dark") {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'menu-');
          document.querySelector(".pcoded-navbar").classList.add("navbar-dark");
          document.querySelector(".layout-css").setAttribute('href', '{% static 'assets/css/layouts/dark.css' %}');
        } else {
          document.querySelector(".layout-css").setAttribute('href', '');
        }
      });
    }
    // // Header Color
    var headercolor = document.querySelectorAll(".header-color > a");
    for (var h = 0; h < headercolor.length; h++) {
      var c = headercolor[h];
      c.addEventListener('click', function (event) {
        document.querySelector(".header-color > a.active").classList.remove("active");
        var targetElement = event.target;
        if (targetElement.tagName == "SPAN") {
          targetElement = targetElement.parentNode;
        }
        targetElement.classList.add("active");
        var temp = targetElement.getAttribute('data-value');
        if (temp == "header-default") {
          removeClassByPrefix(document.querySelector(".pcoded-header"), 'header-');
        } else {
          removeClassByPrefix(document.querySelector(".pcoded-header"), 'header-');
          document.querySelector(".pcoded-header").classList.add(temp);
        }
      });
    }
    // // Menu Color
    var menucolor = document.querySelectorAll(".navbar-color > a");
    for (var h = 0; h < menucolor.length; h++) {
      var c = menucolor[h];
      c.addEventListener('click', function (event) {
        document.querySelector(".navbar-color > a.active").classList.remove("active");
        var targetElement = event.target;
        if (targetElement.tagName == "SPAN") {
          targetElement = targetElement.parentNode;
        }
        targetElement.classList.add("active");
        var temp = targetElement.getAttribute('data-value');
        if (temp == "navbar-default") {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'navbar-');
        } else {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'navbar-');
          document.querySelector(".pcoded-navbar").classList.add(temp);
        }
      });
    }
    // // Active Color
    var activecolor = document.querySelectorAll(".active-color > a");
    for (var h = 0; h < activecolor.length; h++) {
      var c = activecolor[h];
      c.addEventListener('click', function (event) {
        document.querySelector(".active-color > a.active").classList.remove("active");
        var targetElement = event.target;
        if (targetElement.tagName == "SPAN") {
          targetElement = targetElement.parentNode;
        }
        targetElement.classList.add("active");
        var temp = targetElement.getAttribute('data-value');
        if (temp == "active-default") {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'active-');
        } else {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'active-');
          document.querySelector(".pcoded-navbar").classList.add(temp);
        }
      });
    }
    // // rtl layouts
    var rtllayout = document.querySelector("#theme-rtl");
    rtllayout.addEventListener('click', function () {
      document.querySelector('head').insertAdjacentHTML("beforeend", '<link rel="stylesheet" class="rtl-css" href="">');
      if (rtllayout.checked) {
        document.querySelector(".rtl-css").setAttribute('href', '{% static 'assets/css/layouts/rtl.css' %}');
      } else {
        document.querySelector(".rtl-css").setAttribute('href', '');
      }
    });
    // // Menu Fixed
    var Menufixed = document.querySelector("#menu-fixed");
    Menufixed.addEventListener('click', function () {
      if (Menufixed.checked) {
        document.querySelector(".pcoded-navbar").classList.remove("menupos-static");
      } else {
        document.querySelector(".pcoded-navbar").classList.add("menupos-static");
        setTimeout(function () {
          document.querySelector('.navbar-content').style.cssText = `
                      overflow: visible;
                      height: calc(100% - 70px);
                  `;
        }, 400);
      }
    });
    // // Header Fixed
    var Headerfixed = document.querySelector("#header-fixed");
    Headerfixed.addEventListener('click', function () {
      if (Headerfixed.checked) {
        document.querySelector(".pcoded-header").classList.add("headerpos-fixed");
        document.querySelector(".pcoded-header").classList.add("header-blue");
        document.querySelector(".header-color > a.active").classList.remove("active");
        document.querySelector(".header-color > a[data-value='header-blue']").classList.add("active");
      } else {
        document.querySelector(".pcoded-header").classList.remove("headerpos-fixed");
      }
    });
    // // Menu Icon Color
    var Menuicon = document.querySelector("#icon-colored");
    Menuicon.addEventListener('click', function () {
      if (Menuicon.checked) {
        document.querySelector(".pcoded-navbar").classList.add("icon-colored");
      } else {
        document.querySelector(".pcoded-navbar").classList.remove("icon-colored");
      }
    });
    // // Box layouts
    var boxlayout = document.querySelector("#box-layouts");
    boxlayout.addEventListener('click', function () {
      if (boxlayout.checked) {
        document.querySelector("body").classList.add("container");
        document.querySelector("body").classList.add("box-layout");
      } else {
        document.querySelector("body").classList.remove("container");
        document.querySelector("body").classList.remove("box-layout");
      }
    });
    // // Caption Hide
    var captionhide = document.querySelector("#caption-hide");
    captionhide.addEventListener('click', function () {
      if (captionhide.checked) {
        document.querySelector(".pcoded-navbar").classList.add("caption-hide");
      } else {
        document.querySelector(".pcoded-navbar").classList.remove("caption-hide");
      }
    });

    // // Menu image background
    var Menuimage = document.querySelectorAll(".navbar-images > a");
    for (var h = 0; h < Menuimage.length; h++) {
      var c = Menuimage[h];
      c.addEventListener('click', function (event) {
        if (!!document.querySelector('.navbar-images > a.active')) {
          document.querySelector(".navbar-images > a.active").classList.remove("active");
        }
        var targetElement = event.target;
        if (targetElement.tagName == "SPAN") {
          targetElement = targetElement.parentNode;
        }
        targetElement.classList.add("active");
        var temp = targetElement.getAttribute('data-value');
        removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'menu-');
        removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'navbar-image-');
        document.querySelector(".pcoded-navbar").classList.add(temp);
      });
    }
    // // title Color
    var activecolor = document.querySelectorAll(".title-color > a");
    for (var h = 0; h < activecolor.length; h++) {
      var c = activecolor[h];
      c.addEventListener('click', function (event) {
        document.querySelector(".title-color > a.active").classList.remove("active");
        var targetElement = event.target;
        if (targetElement.tagName == "SPAN") {
          targetElement = targetElement.parentNode;
        }
        targetElement.classList.add("active");
        var temp = targetElement.getAttribute('data-value');
        if (temp == "title-default") {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'title-');
        } else {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'title-');
          document.querySelector(".pcoded-navbar").classList.add(temp);
        }
      });
    }
    // // brand Color
    var brandcolor = document.querySelectorAll(".brand-color > a");
    for (var h = 0; h < brandcolor.length; h++) {
      var c = brandcolor[h];
      c.addEventListener('click', function (event) {
        document.querySelector(".brand-color > a.active").classList.remove("active");
        var targetElement = event.target;
        if (targetElement.tagName == "SPAN") {
          targetElement = targetElement.parentNode;
        }
        targetElement.classList.add("active");
        var temp = targetElement.getAttribute('data-value');
        if (temp == "brand-default") {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'brand-');
        } else {
          removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'brand-');
          document.querySelector(".pcoded-navbar").classList.add(temp);
        }
      });
    }
    // ==================    Menu Customizer End   =============
    // =========================================================
  });
  // Menu Dropdown icon
  function drpicon(temp) {
    if (temp == "style1") {
      removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'drp-icon-');
    } else {
      removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'drp-icon-');
      document.querySelector(".pcoded-navbar").classList.add('drp-icon-' + temp);
    }
  }
  // Menu subitem icon
  function menuitemicon(temp) {
    if (temp == "style1") {
      removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'menu-item-icon-');
    } else {
      removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'menu-item-icon-');
      document.querySelector(".pcoded-navbar").classList.add('menu-item-icon-' + temp);
    }
  }

  function removeClassByPrefix(node, prefix) {
    for (let i = 0; i < node.classList.length; i++) {
      let value = node.classList[i];
      if (value.startsWith(prefix)) {
        node.classList.remove(value);
      }
    }
  }
</script>


{% load static %}

<script>
  "use strict";
  document.addEventListener("DOMContentLoaded", function () {
    // Load saved settings
    const savedSettings = localStorage.getItem('themeSettings');
    if (savedSettings) {
      const settings = JSON.parse(savedSettings);
      applyThemeSettings(settings);
    }

    // Theme settings change handlers
    document.querySelectorAll('.theme-color > a').forEach(element => {
      element.addEventListener('click', function() {
        let temp = this.getAttribute('data-value');
        setThemeColor(temp);
        saveSettings();
      });
    });

    document.querySelectorAll('.header-color > a').forEach(element => {
      element.addEventListener('click', function() {
        let temp = this.getAttribute('data-value');
        setHeaderColor(temp);
        saveSettings();
      });
    });

    document.querySelectorAll('.navbar-color > a').forEach(element => {
      element.addEventListener('click', function() {
        let temp = this.getAttribute('data-value');
        setNavbarColor(temp);
        saveSettings();
      });
    });

    document.querySelectorAll('.layout-type > a').forEach(element => {
      element.addEventListener('click', function() {
        let temp = this.getAttribute('data-value');
        setLayoutType(temp);
        saveSettings();
      });
    });

    // Brand Color
    document.querySelectorAll('.brand-color > a').forEach(element => {
      element.addEventListener('click', function() {
        let temp = this.getAttribute('data-value');
        setBrandColor(temp);
        saveSettings();
      });
    });

    // Active Color
    document.querySelectorAll('.active-color > a').forEach(element => {
      element.addEventListener('click', function() {
        let temp = this.getAttribute('data-value');
        setActiveColor(temp);
        saveSettings();
      });
    });

    // Title Color
    document.querySelectorAll('.title-color > a').forEach(element => {
      element.addEventListener('click', function() {
        let temp = this.getAttribute('data-value');
        setTitleColor(temp);
        saveSettings();
      });
    });

    // Navbar Images
    document.querySelectorAll('.navbar-images > a').forEach(element => {
      element.addEventListener('click', function() {
        let temp = this.getAttribute('data-value');
        setNavbarImage(temp);
        saveSettings();
      });
    });

    // Menu Dropdown Icon
    document.querySelectorAll('input[name="radio-in-1"]').forEach(element => {
      element.addEventListener('change', function() {
        saveSettings();
      });
    });

    // Menu List Icon
    document.querySelectorAll('input[name="radio-in"]').forEach(element => {
      element.addEventListener('change', function() {
        saveSettings();
      });
    });

    // Checkbox handlers - add all checkboxes
    document.querySelector("#theme-rtl").addEventListener('change', function() {
      saveSettings();
    });

    document.querySelector("#menu-fixed").addEventListener('change', function() {
      saveSettings();
    });

    document.querySelector("#header-fixed").addEventListener('change', function() {
      saveSettings();
    });

    document.querySelector("#box-layouts").addEventListener('change', function() {
      saveSettings();
    });

    document.querySelector("#icon-colored").addEventListener('change', function() {
      saveSettings();
    });

    document.querySelector("#caption-hide").addEventListener('change', function() {
      saveSettings();
    });
  });

  // Theme setting functions
  function setThemeColor(temp) {
    removeClassByPrefix(document.querySelector('body'), 'theme-');
    document.querySelector('body').classList.add(temp);
  }

  function setHeaderColor(temp) {
    removeClassByPrefix(document.querySelector('.pcoded-header'), 'header-');
    document.querySelector('.pcoded-header').classList.add(temp);
  }

  function setNavbarColor(temp) {
    removeClassByPrefix(document.querySelector('.pcoded-navbar'), 'navbar-');
    document.querySelector('.pcoded-navbar').classList.add(temp);
  }

  function setLayoutType(temp) {
    removeClassByPrefix(document.querySelector('body'), 'layout-');
    document.querySelector('body').classList.add(temp);
  }

  function setBrandColor(temp) {
    removeClassByPrefix(document.querySelector('.pcoded-navbar'), 'brand-');
    if (temp !== 'brand-default') {
      document.querySelector('.pcoded-navbar').classList.add(temp);
    }
  }

  function setActiveColor(temp) {
    removeClassByPrefix(document.querySelector('.pcoded-navbar'), 'active-');
    if (temp !== 'active-default') {
      document.querySelector('.pcoded-navbar').classList.add(temp);
    }
  }

  function setTitleColor(temp) {
    removeClassByPrefix(document.querySelector('.pcoded-navbar'), 'title-');
    if (temp !== 'title-default') {
      document.querySelector('.pcoded-navbar').classList.add(temp);
    }
  }

  function setNavbarImage(temp) {
    removeClassByPrefix(document.querySelector('.pcoded-navbar'), 'navbar-image-');
    if (temp) {
      document.querySelector('.pcoded-navbar').classList.add(temp);
    }
  }

  function drpicon(temp) {
    removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'drp-icon-');
    if (temp !== 'style1') {
      document.querySelector(".pcoded-navbar").classList.add('drp-icon-' + temp);
    }
    saveSettings();
  }

  function menuitemicon(temp) {
    removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'menu-item-icon-');
    if (temp !== 'style1') {
      document.querySelector(".pcoded-navbar").classList.add('menu-item-icon-' + temp);
    }
    saveSettings();
  }

  function removeClassByPrefix(node, prefix) {
    for (let i = 0; i < node.classList.length; i++) {
      let value = node.classList[i];
      if (value.startsWith(prefix)) {
        node.classList.remove(value);
      }
    }
  }

  // Save settings to localStorage
  function saveSettings() {
    // Get the active dropdown icon style
    let drpIconStyle = 'style1';
    document.querySelectorAll('input[name="radio-in-1"]').forEach(radio => {
      if (radio.checked) {
        drpIconStyle = radio.id.replace('drpicon-', '');
      }
    });

    // Get the active menu item icon style
    let menuIconStyle = 'style1';
    document.querySelectorAll('input[name="radio-in"]').forEach(radio => {
      if (radio.checked) {
        menuIconStyle = radio.id.replace('subitem-', '');
      }
    });

    // Get navbar image if any
    let navbarImage = '';
    const activeNavbarImage = document.querySelector('.navbar-images > a.active');
    if (activeNavbarImage) {
      navbarImage = activeNavbarImage.getAttribute('data-value');
    }

    const settings = {
      // Layout settings
      layoutType: document.querySelector('.layout-type > a.active').getAttribute('data-value'),
      rtlLayout: document.querySelector("#theme-rtl").checked,
      boxLayout: document.querySelector("#box-layouts").checked,

      // Header settings
      headerColor: document.querySelector('.header-color > a.active').getAttribute('data-value'),
      headerFixed: document.querySelector("#header-fixed").checked,

      // Navbar/Menu settings
      navbarColor: document.querySelector('.navbar-color > a.active').getAttribute('data-value'),
      brandColor: document.querySelector('.brand-color > a.active').getAttribute('data-value'),
      activeColor: document.querySelector('.active-color > a.active')?.getAttribute('data-value') || 'active-default',
      titleColor: document.querySelector('.title-color > a.active')?.getAttribute('data-value') || 'title-default',
      menuFixed: document.querySelector("#menu-fixed").checked,
      captionHide: document.querySelector("#caption-hide")?.checked || false,
      navbarImage: navbarImage, // Will be empty string for "None" option

      // Icon settings
      iconColored: document.querySelector("#icon-colored").checked,
      drpIconStyle: drpIconStyle,
      menuIconStyle: menuIconStyle,

      // Enhanced background settings
      bodyBackground: document.body.style.backgroundColor || '',
      darkMode: document.querySelector(".layout-css")?.getAttribute('href') || ''
    };

    localStorage.setItem('themeSettings', JSON.stringify(settings));
    console.log('Settings saved:', settings);
  }

  // Apply saved settings
  function applyThemeSettings(settings) {
    // Apply layout settings
    setLayoutType(settings.layoutType);
    if (settings.rtlLayout) {
      document.querySelector("#theme-rtl").checked = true;
      document.querySelector('head').insertAdjacentHTML("beforeend", '<link rel="stylesheet" class="rtl-css" href="{% static "assets/css/layouts/rtl.css" %}">');
    }
    if (settings.boxLayout) {
      document.querySelector("#box-layouts").checked = true;
      document.querySelector("body").classList.add("container", "box-layout");
    }

    // Apply header settings
    setHeaderColor(settings.headerColor);
    document.querySelector('.header-color > a.active').classList.remove('active');
    document.querySelector(`.header-color > a[data-value="${settings.headerColor}"]`).classList.add('active');
    if (settings.headerFixed) {
      document.querySelector("#header-fixed").checked = true;
      document.querySelector(".pcoded-header").classList.add("headerpos-fixed");
    }

    // Apply navbar/menu settings
    setNavbarColor(settings.navbarColor);
    document.querySelector('.navbar-color > a.active').classList.remove('active');
    document.querySelector(`.navbar-color > a[data-value="${settings.navbarColor}"]`).classList.add('active');

    setBrandColor(settings.brandColor);
    document.querySelector('.brand-color > a.active').classList.remove('active');
    document.querySelector(`.brand-color > a[data-value="${settings.brandColor}"]`).classList.add('active');

    // Apply Active and Title colors if they exist in the DOM
    if (document.querySelector('.active-color') && settings.activeColor) {
      setActiveColor(settings.activeColor);
      document.querySelector('.active-color > a.active').classList.remove('active');
      document.querySelector(`.active-color > a[data-value="${settings.activeColor}"]`).classList.add('active');
    }

    if (document.querySelector('.title-color') && settings.titleColor) {
      setTitleColor(settings.titleColor);
      document.querySelector('.title-color > a.active').classList.remove('active');
      document.querySelector(`.title-color > a[data-value="${settings.titleColor}"]`).classList.add('active');
    }

    if (settings.menuFixed) {
      document.querySelector("#menu-fixed").checked = true;
      document.querySelector(".pcoded-navbar").classList.remove("menupos-static");
    } else {
      document.querySelector(".pcoded-navbar").classList.add("menupos-static");
    }

    if (settings.captionHide && document.querySelector("#caption-hide")) {
      document.querySelector("#caption-hide").checked = true;
      document.querySelector(".pcoded-navbar").classList.add("caption-hide");
    }

    // Apply navbar image if present
    if (settings.navbarImage) {
      setNavbarImage(settings.navbarImage);
      if (document.querySelector('.navbar-images > a.active')) {
        document.querySelector('.navbar-images > a.active').classList.remove('active');
      }
      document.querySelector(`.navbar-images > a[data-value="${settings.navbarImage}"]`).classList.add('active');
    } else {
      // Set the NONE option to active
      if (document.querySelector('.navbar-images > a.active')) {
        document.querySelector('.navbar-images > a.active').classList.remove('active');
      }
      document.querySelector('.navbar-images > a[data-value=""]').classList.add('active');
    }

    // Apply icon settings
    if (settings.iconColored) {
      document.querySelector("#icon-colored").checked = true;
      document.querySelector(".pcoded-navbar").classList.add("icon-colored");
    }

    // Apply dropdown icon style
    if (settings.drpIconStyle && settings.drpIconStyle !== 'style1') {
      const drpIconElement = document.querySelector(`#drpicon-${settings.drpIconStyle}`);
      if (drpIconElement) {
        drpIconElement.checked = true;
        document.querySelector(".pcoded-navbar").classList.add(`drp-icon-${settings.drpIconStyle}`);
      }
    }

    // Apply menu item icon style
    if (settings.menuIconStyle && settings.menuIconStyle !== 'style1') {
      const menuIconElement = document.querySelector(`#subitem-${settings.menuIconStyle}`);
      if (menuIconElement) {
        menuIconElement.checked = true;
        document.querySelector(".pcoded-navbar").classList.add(`menu-item-icon-${settings.menuIconStyle}`);
      }
    }

    // Apply background settings
    if (settings.bodyBackground) {
      document.body.style.backgroundColor = settings.bodyBackground;
    }

    // Apply dark mode if needed
    if (settings.darkMode && settings.darkMode.includes('dark.css')) {
      document.querySelector(".layout-css")?.setAttribute('href', settings.darkMode);
      // Ensure dark theme is set properly
      removeClassByPrefix(document.querySelector(".pcoded-navbar"), 'menu-');
      document.querySelector(".pcoded-navbar").classList.add("navbar-dark");
    }

    console.log('Settings applied:', settings);
  }

  // Your existing functions (setThemeColor, setHeaderColor, etc.) would remain
</script>

